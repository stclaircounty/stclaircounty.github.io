{{/*
  Related items links section for detail pages

  Params:
    - data: map - The data object containing related_* fields
    - title: string (optional) - Section title. Pass false or omit to show default "Related Items". Pass "" to hide title.
    - showTitle: bool (optional) - Set to false to hide the title entirely
*/}}
{{ $data := .data }}
{{ $showTitle := true }}
{{ if isset . "title" }}
  {{ if eq .title "" }}
    {{ $showTitle = false }}
  {{ end }}
{{ end }}
{{ $title := .title | default "Related Items" }}

{{ $hasRelated := or $data.related_incidents $data.related_depositions $data.related_evidence $data.related_timeline }}

{{ if $hasRelated }}
{{ if and $showTitle $title }}
<h3 class="text-lg font-bold text-navy mb-4 flex items-center gap-2">
  <svg class="h-5 w-5 text-slate-light" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
  </svg>
  {{ $title }}
</h3>
{{ end }}

<div class="flex flex-wrap gap-4">
    {{/* Related Incidents */}}
    {{ with $data.related_incidents }}
    <div class="flex-1 min-w-[200px] bg-red-50 rounded-lg p-4">
      <h4 class="text-sm font-semibold text-red-800 mb-2 flex items-center gap-1">
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
        </svg>
        Incidents
      </h4>
      <ul class="space-y-1">
        {{ range . }}
        {{ $incident := index site.Data.incidents . }}
        <li>
          <a href="/incidents/{{ . }}/" class="text-sm text-red-700 hover:text-red-900 hover:underline">
            {{ with $incident }}{{ .title }}{{ else }}{{ . | humanize }}{{ end }}
          </a>
        </li>
        {{ end }}
      </ul>
    </div>
    {{ end }}

    {{/* Related Depositions */}}
    {{ with $data.related_depositions }}
    <div class="flex-1 min-w-[200px] bg-gold/10 rounded-lg p-4">
      <h4 class="text-sm font-semibold text-gold mb-2 flex items-center gap-1">
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg>
        Depositions
      </h4>
      <ul class="space-y-1">
        {{ range . }}
        {{ $depo := index site.Data.depositions . }}
        <li>
          <a href="/depositions/{{ . }}/" class="text-sm text-gold hover:text-yellow-700 hover:underline">
            {{ with $depo }}{{ .title }}{{ else }}{{ . | humanize }}{{ end }}
          </a>
        </li>
        {{ end }}
      </ul>
    </div>
    {{ end }}

    {{/* Related Evidence */}}
    {{ with $data.related_evidence }}
    <div class="flex-1 min-w-[200px] bg-purple-50 rounded-lg p-4">
      <h4 class="text-sm font-semibold text-purple-800 mb-2 flex items-center gap-1">
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
        </svg>
        Evidence
      </h4>
      <ul class="space-y-1">
        {{ range . }}
        {{ $evidence := index site.Data.evidence . }}
        <li>
          <a href="/evidence/{{ . }}/" class="text-sm text-purple-700 hover:text-purple-900 hover:underline">
            {{ with $evidence }}{{ .title }}{{ else }}{{ . | humanize }}{{ end }}
          </a>
        </li>
        {{ end }}
      </ul>
    </div>
    {{ end }}

    {{/* Related Timeline */}}
    {{ with $data.related_timeline }}
    <div class="flex-1 min-w-[200px] bg-blue-50 rounded-lg p-4">
      <h4 class="text-sm font-semibold text-blue-800 mb-2 flex items-center gap-1">
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        Timeline
      </h4>
      <ul class="space-y-1">
        {{ range . }}
        {{ $event := index site.Data.timeline . }}
        <li>
          <a href="/timeline/#{{ . }}" class="text-sm text-blue-700 hover:text-blue-900 hover:underline">
            {{ with $event }}{{ .title }}{{ else }}{{ . | humanize }}{{ end }}
          </a>
        </li>
        {{ end }}
      </ul>
    </div>
    {{ end }}
</div>
{{ end }}
