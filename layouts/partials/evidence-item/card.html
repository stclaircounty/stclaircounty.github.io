{{/*
  Evidence card for list pages

  Params:
    - key: string - The evidence key from data
    - data: map - The evidence data object
*/}}
{{ $key := .key }}
{{ $data := .data }}
{{ $href := printf "/evidence/%s/" $key }}

<article class="card hover:shadow-md transition-shadow group" data-type="{{ $data.evidence_type | default "document" }}">
  {{/* Header */}}
  {{ partial "case-file/card-header.html" (dict "data" $data "type" "evidence") }}

  {{/* Title */}}
  <h2 class="text-lg font-bold text-navy mb-2 group-hover:text-accent transition-colors">
    <a href="{{ $href }}">{{ $data.title }}</a>
  </h2>

  {{/* Source */}}
  {{ with $data.source }}
  <p class="text-sm text-slate-light mb-2 flex items-center gap-1">
    {{ partial "header-icon.html" (dict "icon" "building" "class" "h-4 w-4") }}
    {{ . }}
  </p>
  {{ end }}

  {{/* Summary */}}
  {{ with $data.summary }}
  <p class="text-slate text-sm mb-3">{{ . | plainify | truncate 120 }}</p>
  {{ end }}

  {{/* Files count */}}
  {{ with $data.files }}
  <div class="mb-3">
    {{ partial "components/stat.html" (dict "icon" "database" "count" (len .) "label" (cond (gt (len .) 1) "files" "file") "size" "sm") }}
  </div>
  {{ end }}

  {{/* Establishes preview */}}
  {{ with $data.establishes }}
  {{ partial "components/tag-list.html" (dict "tags" . "max" 2 "color" "teal" "class" "mb-3") }}
  {{ end }}

  {{/* Related Incident Link */}}
  {{ with $data.related_incidents }}
  {{ $incidentKey := index . 0 }}
  {{ $incident := index site.Data.incidents $incidentKey }}
  {{ if $incident }}
  <a href="/incidents/{{ $incidentKey }}/" class="flex items-center gap-2 mb-3 px-2.5 py-1.5 bg-navy/5 hover:bg-navy/10 rounded-lg transition-colors group/incident">
    {{ partial "header-icon.html" (dict "icon" "warning" "class" "w-4 h-4 text-accent flex-shrink-0") }}
    <span class="text-xs text-navy group-hover/incident:text-accent transition-colors truncate">{{ $incident.title }}</span>
  </a>
  {{ end }}
  {{ end }}

  {{/* Footer */}}
  {{ partial "case-file/card-footer.html" (dict "href" $href "type" "evidence" "data" $data) }}
</article>
