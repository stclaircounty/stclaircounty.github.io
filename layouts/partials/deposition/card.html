{{/*
  Deposition card for list pages

  Params:
    - key: string - The deposition key from data
    - data: map - The deposition data object
*/}}
{{ $key := .key }}
{{ $data := .data }}
{{ $href := printf "/depositions/%s/" $key }}

<article class="card hover:shadow-md transition-shadow group">
  {{/* Header */}}
  {{ partial "case-file/card-header.html" (dict "data" $data "type" "deposition") }}

  {{/* Title */}}
  <h2 class="text-xl font-bold text-navy mb-2 group-hover:text-accent transition-colors">
    <a href="{{ $href }}">{{ $data.title }}</a>
  </h2>

  {{/* Deponent */}}
  {{ with $data.deponent }}
  <p class="text-slate mb-3">
    <span class="text-slate-light">Deponent:</span>
    {{ $hasPage := site.GetPage (printf "/people/%s" .id) }}
    {{ if $hasPage }}
    <a href="/people/{{ .id }}/" class="font-medium text-navy hover:text-accent">{{ .name }}</a>
    {{ else }}
    <span class="font-medium">{{ .name }}</span>
    {{ end }}
    {{ with .role }}<span class="text-slate-light">({{ . }})</span>{{ end }}
  </p>
  {{ end }}

  {{/* Key Quote Preview */}}
  {{ with $data.key_quotes }}
  {{ $quote := index . 0 }}
  {{ partial "components/quote.html" (dict "text" ($quote.text | truncate 150) "page" $quote.page "variant" "compact" "class" "mb-4") }}
  {{ end }}

  {{/* Topics */}}
  {{ with $data.topics }}
  {{ partial "components/tag-list.html" (dict "tags" . "max" 4 "color" "amber" "class" "mb-3") }}
  {{ end }}

  {{/* Related Incident Link */}}
  {{ with $data.related_incidents }}
  {{ $incidentKey := index . 0 }}
  {{ $incident := index site.Data.incidents $incidentKey }}
  {{ if $incident }}
  <a href="/incidents/{{ $incidentKey }}/" class="flex items-center gap-2 mb-3 px-2.5 py-1.5 bg-navy/5 hover:bg-navy/10 rounded-lg transition-colors group/incident">
    {{ partial "header-icon.html" (dict "icon" "warning" "class" "w-4 h-4 text-accent flex-shrink-0") }}
    <span class="text-xs text-navy group-hover/incident:text-accent transition-colors truncate">{{ $incident.title }}</span>
  </a>
  {{ end }}
  {{ end }}

  {{/* Footer */}}
  {{ partial "case-file/card-footer.html" (dict "href" $href "type" "deposition" "data" $data) }}
</article>
