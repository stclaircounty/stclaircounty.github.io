{{/*
  Tag List - Display tags with optional overflow handling

  Usage:
    {{ partial "components/tag-list.html" (dict "tags" .tags "max" 4) }}

  Parameters:
    - tags: slice of strings (required)
    - max: int (optional) - Maximum tags to show before "+X more" (default: 0 = show all)
    - color: string (optional) - "slate" (default), "amber", "blue", "red", etc.
    - size: string (optional) - "sm", "md" (default)
    - linked: bool (optional) - Make tags clickable (links to /tags/tagname/)
    - class: string (optional) - Additional wrapper classes
*/}}

{{ $tags := .tags }}
{{ $max := .max | default 0 }}
{{ $color := .color | default "slate" }}
{{ $size := .size | default "md" }}
{{ $linked := .linked | default false }}
{{ $class := .class | default "" }}

{{/* Size classes */}}
{{ $sizeClass := "text-xs px-2 py-0.5" }}
{{ if eq $size "sm" }}
  {{ $sizeClass = "text-[10px] px-1.5 py-0.5" }}
{{ end }}

{{/* Color classes */}}
{{ $colorClass := "bg-slate-100 text-slate-600 hover:bg-slate-200" }}
{{ if eq $color "amber" }}
  {{ $colorClass = "bg-amber-50 text-amber-700 hover:bg-amber-100" }}
{{ else if eq $color "blue" }}
  {{ $colorClass = "bg-blue-50 text-blue-700 hover:bg-blue-100" }}
{{ else if eq $color "red" }}
  {{ $colorClass = "bg-red-50 text-red-700 hover:bg-red-100" }}
{{ else if eq $color "green" }}
  {{ $colorClass = "bg-green-50 text-green-700 hover:bg-green-100" }}
{{ else if eq $color "purple" }}
  {{ $colorClass = "bg-purple-50 text-purple-700 hover:bg-purple-100" }}
{{ else if eq $color "teal" }}
  {{ $colorClass = "bg-teal-50 text-teal-700 hover:bg-teal-100" }}
{{ end }}

{{ with $tags }}
<div class="flex flex-wrap gap-1.5 {{ $class }}">
  {{ $displayTags := . }}
  {{ $remaining := 0 }}

  {{ if and (gt $max 0) (gt (len .) $max) }}
    {{ $displayTags = first $max . }}
    {{ $remaining = sub (len .) $max }}
  {{ end }}

  {{ range $displayTags }}
    {{ if $linked }}
    <a href="/tags/{{ . | urlize }}/" class="{{ $sizeClass }} {{ $colorClass }} rounded transition-colors">
      {{ . | humanize }}
    </a>
    {{ else }}
    <span class="{{ $sizeClass }} {{ $colorClass }} rounded">
      {{ . | humanize }}
    </span>
    {{ end }}
  {{ end }}

  {{ if gt $remaining 0 }}
  <span class="{{ $sizeClass }} text-slate-400">+{{ $remaining }} more</span>
  {{ end }}
</div>
{{ end }}
