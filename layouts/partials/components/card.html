{{/*
  Card - Base card component for content items

  Usage:
    {{ partial "components/card.html" (dict
      "href" "/incidents/example/"
      "title" "Card Title"
      "subtitle" "Optional subtitle"
      "date" "2024-01-15"
      "badges" (slice (dict "type" "severity" "value" "high"))
      "content" "Card body content"
      "footer" $footerContent
    ) }}

  Parameters:
    - href: string (optional) - Makes card clickable
    - title: string (required) - Card heading
    - subtitle: string (optional) - Secondary heading
    - date: string (optional) - Date to display
    - badges: slice (optional) - Array of badge dicts {type, value, color}
    - icon: string (optional) - Icon for the card
    - iconBg: string (optional) - Icon background color
    - iconColor: string (optional) - Icon color
    - content: string (optional) - Card body content
    - footer: string (optional) - Footer content (HTML)
    - image: string (optional) - Image URL for card header
    - accentColor: string (optional) - Left border accent color
    - class: string (optional) - Additional wrapper classes
*/}}

{{ $href := .href }}
{{ $title := .title }}
{{ $subtitle := .subtitle }}
{{ $date := .date }}
{{ $badges := .badges }}
{{ $icon := .icon }}
{{ $iconBg := .iconBg | default "bg-slate-100" }}
{{ $iconColor := .iconColor | default "text-slate-600" }}
{{ $content := .content }}
{{ $footer := .footer }}
{{ $image := .image }}
{{ $accentColor := .accentColor }}
{{ $class := .class | default "" }}

{{/* Accent border class */}}
{{ $accentClass := "" }}
{{ with $accentColor }}
  {{ if eq . "red" }}{{ $accentClass = "border-l-4 border-l-red-500" }}
  {{ else if eq . "orange" }}{{ $accentClass = "border-l-4 border-l-orange-500" }}
  {{ else if eq . "amber" }}{{ $accentClass = "border-l-4 border-l-amber-500" }}
  {{ else if eq . "yellow" }}{{ $accentClass = "border-l-4 border-l-yellow-500" }}
  {{ else if eq . "green" }}{{ $accentClass = "border-l-4 border-l-green-500" }}
  {{ else if eq . "blue" }}{{ $accentClass = "border-l-4 border-l-blue-500" }}
  {{ else if eq . "purple" }}{{ $accentClass = "border-l-4 border-l-purple-500" }}
  {{ else }}{{ $accentClass = printf "border-l-4 border-l-%s-500" . }}{{ end }}
{{ end }}

{{ $wrapperClass := printf "bg-white rounded-lg border border-slate-200 overflow-hidden transition-all %s %s" $accentClass $class }}

{{ if $href }}
<a href="{{ $href }}" class="{{ $wrapperClass }} hover:shadow-md hover:border-slate-300 group block">
{{ else }}
<div class="{{ $wrapperClass }}">
{{ end }}

  {{/* Optional image header */}}
  {{ with $image }}
  <div class="aspect-video bg-slate-100 overflow-hidden">
    <img src="{{ . }}" alt="{{ $title }}" class="w-full h-full object-cover group-hover:scale-105 transition-transform">
  </div>
  {{ end }}

  {{/* Card body */}}
  <div class="p-5">
    {{/* Header row: icon, title, badges */}}
    <div class="flex items-start gap-3">
      {{ with $icon }}
      <div class="flex-shrink-0 p-2 {{ $iconBg }} rounded-lg">
        {{ partial "header-icon.html" (dict "icon" . "class" (printf "w-5 h-5 %s" $iconColor)) }}
      </div>
      {{ end }}

      <div class="flex-1 min-w-0">
        {{/* Date and badges row */}}
        {{ if or $date $badges }}
        <div class="flex flex-wrap items-center gap-2 mb-1.5">
          {{ with $date }}
          <span class="text-xs text-slate-500">{{ . | time.Format "Jan 2, 2006" }}</span>
          {{ end }}
          {{ range $badges }}
          {{ partial "components/badge.html" . }}
          {{ end }}
        </div>
        {{ end }}

        {{/* Title */}}
        <h3 class="font-semibold text-navy {{ if $href }}group-hover:text-amber-600 transition-colors{{ end }}" style="margin: 0;">
          {{ $title }}
        </h3>

        {{/* Subtitle */}}
        {{ with $subtitle }}
        <p class="text-sm text-slate-500 mt-1 mb-0">{{ . }}</p>
        {{ end }}
      </div>
    </div>

    {{/* Content */}}
    {{ with $content }}
    <div class="mt-3 text-sm text-slate-600">
      {{ . }}
    </div>
    {{ end }}
  </div>

  {{/* Footer */}}
  {{ with $footer }}
  <div class="px-5 py-3 bg-slate-50 border-t border-slate-100">
    {{ . }}
  </div>
  {{ end }}

{{ if $href }}
</a>
{{ else }}
</div>
{{ end }}
