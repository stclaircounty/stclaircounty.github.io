{{/*
  Quote Shortcode - For styled deposition quotes with citations

  Usage:
    {{< quote source="Sheriff Mat King" page="73" deposition="mat-king-deposition" >}}
    When asked why he didn't call me to tell me that one of our deputies got arrested,
    he told me it was a conflict of interest.
    {{< /quote >}}

  Parameters:
    - source: Person being quoted (optional)
    - page: Page number in transcript (optional)
    - deposition: Deposition slug for linking (optional)
    - type: "question" or "answer" for Q&A styling (optional)
*/}}

{{ $source := .Get "source" }}
{{ $page := .Get "page" }}
{{ $deposition := .Get "deposition" }}
{{ $type := .Get "type" }}
{{ $text := .Inner | markdownify }}

<div class="my-6 relative">
  {{/* Accent bar */}}
  <div class="absolute left-0 top-0 bottom-0 w-1 rounded-full
    {{ if eq $type "question" }}bg-blue-500
    {{ else if eq $type "answer" }}bg-green-500
    {{ else }}bg-amber-500{{ end }}"></div>

  <blockquote class="pl-6 pr-4 py-4 bg-slate-50 rounded-r-lg border-y border-r border-slate-200">
    {{/* Q/A indicator if specified */}}
    {{ if eq $type "question" }}
    <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 text-xs font-bold mr-2">Q</span>
    {{ else if eq $type "answer" }}
    <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-green-100 text-green-700 text-xs font-bold mr-2">A</span>
    {{ end }}

    <p class="text-slate-700 text-lg leading-relaxed italic inline">{{ $text }}</p>

    {{/* Citation line */}}
    {{ if or $source $page $deposition }}
    <footer class="mt-3 flex items-center gap-2 text-sm text-slate-500">
      <svg class="w-4 h-4 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
      </svg>
      {{ with $source }}<span class="font-medium text-slate-700">{{ . }}</span>{{ end }}
      {{ if and $source $page }}<span class="text-slate-400">|</span>{{ end }}
      {{ with $page }}<span>Page {{ . }}</span>{{ end }}
      {{ with $deposition }}
      <a href="/depositions/{{ . }}/" class="ml-auto text-amber-600 hover:text-amber-700 font-medium inline-flex items-center gap-1">
        View Deposition
        <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </a>
      {{ end }}
    </footer>
    {{ end }}
  </blockquote>
</div>
